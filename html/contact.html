<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/index.css">
    <link rel="stylesheet" href="../css/form.css">
    <script src="https://kit.fontawesome.com/9ad53a0800.js" crossorigin="anonymous"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/emailjs-com@2/dist/email.min.js"></script>
    <title>Kieran's Portfolio</title>



    <div class="navbar">
        <div class='header-div-img'>
            <a href="../html/index.html">
                <img class='icon' src="/resources/images/flat.png">
            </a>
        </div>
        <div class='header-div'>
            <div class="dropdown">
                <a class="dropbtn">
                    <p class='nav-button'>
                        Projects

                        <i class="fa fa-caret-down"></i>
                    </p>
                </a>
                <div class="dropdown-content">
                    <a href="../html/this-site.html">This Site</a>
                    <a href="../html/java-game-engine.html">Java Game Engine</a>
                    <a href="../html/java-payment-api.html">Java Payment API</a>
                </div>
            </div>
        </div>
        <div class='header-div'>
            <a href="../html/about-me.html" class='button'>
                <p class='nav-button'>
                    About Me
                </p>
            </a>
        </div>
        <div class='header-div'>
            <a href="../html/contact.html" class='button'>
                <p class='nav-button'>
                    Contact
                </p>
            </a>
        </div>
        <div class='header-div'>
            <a href="../html/resume.html" class='button'>
                <p class='nav-button'>
                    Resume
                </p>
            </a>
        </div>

    </div>

</head>

<body>
    <form action="" method="post" enctype="text/plain" id="form">
        <div id="email-input-div">
            <p>
                Your Email:
            </p>
            <input type="email" name="email" id="email-input" required>
        </div>
        <div id="message-input-div">
            <p>
                Message:
            </p>
            <textarea style="resize: none;" name="message" rows="10" cols="30" id="message-input" required></textarea>
        </div>
        <div>

            <input type="button" value="Send Email" onclick="sendEmail()" id="submit-button">
        </div>
        <script>
            function sendEmail() {
                let errormsg = document.getElementById('submit-error');
                let submit = document.getElementById('submit-button');
                let form = document.getElementById('form');
                if (form.checkValidity()) {

                    if (submit.value == "Send Email") {
                        var templateParams = {
                            email: document.getElementById('email-input').value,
                            message: document.getElementById('message-input').value
                        };
                        submit.value = "Sent!";
                        submit.style.backgroundColor = "#111";
                        submit.style.color = "#EEE";
                        document.getElementById('email-input-div').style.display = 'none';
                        document.getElementById('message-input-div').style.display = 'none';

                        errormsg.textContent = "";

                        emailjs.send('service_becskri', 'template_j3wwa4o', templateParams, 'user_GyV8SgPk4F0RQTr0bTlSX')
                            .then(function(response) {
                                console.log('SUCCESS!', response.status, response.text);
                            }, function(error) {
                                console.log('FAILED...', error);
                            });
                    }
                } else {

                    errormsg.textContent = "All fields must be filled!";

                }
            }
        </script>
        <p id="submit-error">
        </p>
    </form>


    <script src="https://cdn.jsdelivr.net/npm/@widgetbot/crate@3" async defer>
        new Crate({
            server: '638797184191430715',
            channel: '638797184690814997'
        })
    </script>


</body>